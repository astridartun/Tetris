(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))r(t);new MutationObserver(t=>{for(const s of t)if(s.type==="childList")for(const y of s.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&r(y)}).observe(document,{childList:!0,subtree:!0});function n(t){const s={};return t.integrity&&(s.integrity=t.integrity),t.referrerPolicy&&(s.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?s.credentials="include":t.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(t){if(t.ep)return;t.ep=!0;const s=n(t);fetch(t.href,s)}})();const p=20,u=14,v=30,m={LEFT:"ArrowLeft",DOWN:"ArrowDown",RIGHT:"ArrowRight"},f=document.querySelector("canvas"),l=f.getContext("2d"),T=document.querySelector("span");let O=0;f.width=p*u;f.height=p*v;l.scale(p,p);const a=M(u,v);function M(o,i){return Array(i).fill().map(()=>Array(o).fill(null))}const d=["red","cyan","blue","orange","green","purple","yellow","pink"],h=[[[1,1],[1,1]],[[1,1,1,1]],[[0,1,0],[1,1,1]],[[1,1,0],[0,1,1]],[[1,0],[1,0],[1,1]],[[1,1],[0,1],[1,1]],[[0,1],[0,1],[0,1]],[[0,1,1],[1,1,0]]],e={position:{x:5,y:5},shape:h[Math.floor(Math.random()*h.length)],color:d[Math.floor(Math.random()*d.length)]};let E=0,x=0;function A(o=0){const i=o-x;x=o,E+=i,E>1e3&&(e.position.y++,E=0,c()&&(e.position.y--,g(),w())),R(),window.requestAnimationFrame(A)}function R(){l.fillStyle="#000",l.fillRect(0,0,f.width,f.height),a.forEach((o,i)=>{o.forEach((n,r)=>{n&&(l.fillStyle=n.color,l.fillRect(r,i,1,1))})}),e.shape.forEach((o,i)=>{o.forEach((n,r)=>{n&&(l.fillStyle=e.color,l.fillRect(r+e.position.x,i+e.position.y,1,1))})}),T.innerText=O}document.addEventListener("keydown",o=>{if(o.key==m.LEFT&&(e.position.x--,c()&&e.position.x++),o.key==m.RIGHT&&(e.position.x++,c()&&e.position.x--),o.key==m.DOWN&&(e.position.y++,c()&&(e.position.y--,g(),w())),o.key=="ArrowUp"){const i=[];for(let r=0;r<e.shape[0].length;r++){const t=[];for(let s=e.shape.length-1;s>=0;s--)t.push(e.shape[s][r]);i.push(t)}const n=e.shape;e.shape=i,c()&&(e.shape=n)}});function c(){return e.shape.find((o,i)=>o.find((n,r)=>{var t;return n!=0&&((t=a[i+e.position.y])==null?void 0:t[r+e.position.x])!==null}))}function g(){e.shape.forEach((o,i)=>{o.forEach((n,r)=>{n==1&&(a[i+e.position.y][r+e.position.x]={color:e.color})})}),e.position.x=Math.floor(u/2-2),e.position.y=0,e.shape=h[Math.floor(Math.random()*h.length)],e.color=d[Math.floor(Math.random()*d.length)],c()&&(window.alert("Game over!!! Sorry!"),a.forEach(o=>o.fill(0)))}const L=new Audio("./clear.mp3");function w(){const o=[];a.forEach((i,n)=>{i.every(r=>r!==null)&&o.push(n)}),o.length>0&&(L.currentTime=0,L.play()),o.forEach(i=>{a.splice(i,1);const n=Array(u).fill(null);a.unshift(n),O+=10})}const S=document.querySelector("section");S.addEventListener("click",()=>{A(),S.remove();const o=new window.Audio("./tetris.mp3");o.volume=.5,o.play()});document.getElementById("left").addEventListener("click",()=>{e.position.x--,c()&&e.position.x++});document.getElementById("right").addEventListener("click",()=>{e.position.x++,c()&&e.position.x--});document.getElementById("down").addEventListener("click",()=>{e.position.y++,c()&&(e.position.y--,g(),w())});document.getElementById("rotate").addEventListener("click",()=>{const o=[];for(let n=0;n<e.shape[0].length;n++){const r=[];for(let t=e.shape.length-1;t>=0;t--)r.push(e.shape[t][n]);o.push(r)}const i=e.shape;e.shape=o,c()&&(e.shape=i)});
