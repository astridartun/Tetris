(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const y of s.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&n(y)}).observe(document,{childList:!0,subtree:!0});function i(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=i(r);fetch(r.href,s)}})();const p=20,h=14,S=30,m={LEFT:"ArrowLeft",DOWN:"ArrowDown",RIGHT:"ArrowRight"},f=document.querySelector("canvas"),c=f.getContext("2d"),M=document.querySelector("span");let A=0;f.width=p*h;f.height=p*S;c.scale(p,p);const l=R(h,S);function R(e,t){return Array(t).fill().map(()=>Array(e).fill(null))}const u=["red","cyan","blue","orange","green","purple","yellow","pink"],d=[[[1,1],[1,1]],[[1,1,1,1]],[[0,1,0],[1,1,1]],[[1,1,0],[0,1,1]],[[1,0],[1,0],[1,1]],[[1,1],[0,1],[1,1]],[[0,1],[0,1],[0,1]],[[0,1,1],[1,1,0]]],o={position:{x:5,y:5},shape:d[Math.floor(Math.random()*d.length)],color:u[Math.floor(Math.random()*u.length)]};let w=0,E=0;function T(e=0){const t=e-E;E=e,w+=t,w>1e3&&(o.position.y++,w=0,a()&&(o.position.y--,x(),L())),v(),window.requestAnimationFrame(T)}function v(){c.fillStyle="#000",c.fillRect(0,0,f.width,f.height),l.forEach((e,t)=>{e.forEach((i,n)=>{i&&(c.fillStyle=i.color,c.fillRect(n,t,1,1))})}),o.shape.forEach((e,t)=>{e.forEach((i,n)=>{i&&(c.fillStyle=o.color,c.fillRect(n+o.position.x,t+o.position.y,1,1))})}),M.innerText=A}document.addEventListener("keydown",e=>{if(e.key==m.LEFT&&(o.position.x--,a()&&o.position.x++),e.key==m.RIGHT&&(o.position.x++,a()&&o.position.x--),e.key==m.DOWN&&(o.position.y++,a()&&(o.position.y--,x(),L())),e.key=="ArrowUp"){const t=[];for(let n=0;n<o.shape[0].length;n++){const r=[];for(let s=o.shape.length-1;s>=0;s--)r.push(o.shape[s][n]);t.push(r)}const i=o.shape;o.shape=t,a()&&(o.shape=i)}});function a(){return o.shape.find((e,t)=>e.find((i,n)=>{var r;return i!=0&&((r=l[t+o.position.y])==null?void 0:r[n+o.position.x])!==null}))}function x(){o.shape.forEach((e,t)=>{e.forEach((i,n)=>{i==1&&(l[t+o.position.y][n+o.position.x]={color:o.color})})}),o.position.x=Math.floor(h/2-2),o.position.y=0,o.shape=d[Math.floor(Math.random()*d.length)],o.color=u[Math.floor(Math.random()*u.length)],a()&&(window.alert("Game over!!! Sorry!"),l.forEach(e=>e.fill(0)))}const g=new Audio("./clear.mp3");function L(){const e=[];l.forEach((t,i)=>{t.every(n=>n!==null)&&e.push(i)}),e.length>0&&(g.currentTime=0,g.play()),e.forEach(t=>{l.splice(t,1);const i=Array(h).fill(null);l.unshift(i),A+=10})}const O=document.querySelector("section");O.addEventListener("click",()=>{T(),O.remove();const e=new window.Audio("./tetris.mp3");e.volume=.5,e.play()});
